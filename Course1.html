<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ุงููุดุฑูุน ุงูุงูู: ุงูุชุฑุชูุจ ุงูุดุฌุฑู</title>
 <link rel="icon" type="image/png" href="UQULOGO.png">
  <!-- CSS FILE (THIS WAS MISSING) -->
  <link rel="stylesheet" href="style.css">
</head>

<body>
<!-- Article content hidden in HTML -->

<a href="https://zorm-dx.github.io/my-course-website/" class="back-button">โ ุงูุนูุฏุฉ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>

<div class="layout">

 <!-- VIDEO SECTION -->
<div class="video-area">
  <div class="video-placeholder" id="videoContainer">
    ุงุฎุชุฑ ุฏุฑุณูุง ูุจุฏุก ุงููุดุงูุฏุฉ
  </div>
</div>


  <!-- SIDEBAR -->
 <div class="sidebar">
  <button class="accordion">๐ ููุฏูุฉ</button>
<div class="panel">
<a href="#"
   class="video-link"
   data-video="https://www.youtube.com/embed/-i5wdgPHglI?si=EmbROkoI4thlqXni">
  ููุฏูุฉ ุงููุดุฑูุน ุงูุงูู
</a>

<a href="#"
   class="video-link"
   data-video="https://www.youtube.com/embed/Z9SLIeIBW9U?si=WDzaGdlvuKgVixcJ">
	ุงุฎุชุจุงุฑ ุนููู ูููุดุฑูุน ุงูุงูู
</a>

</div>


 <button class="accordion">๐ ุดุฑุญ ุชูุตููู ูููุดุฑูุน</button>
<div class="panel">

<a href="#"
   class="video-link"
   data-video="https://www.youtube.com/embed/7Ny_UYDQ3yQ?si=67TC2Z2Ge6LbXhjw">
	ููููุฉ ุงูุดุงุก ุดุฌุฑุฉ ูุนูููุงุชูุฉ
</a>

<a href="#"
   class="video-link"
   data-video="https://www.youtube.com/embed/cxV7n6K_bMc?si=WAx5-tim2DK4Na8q">
	ุทุฑููุฉ ุนูู ุฌุฏุงูู ูููู ุฌุฏุงูู ุงูุดุฌุฑุฉ
</a>

<a href="#"
   class="video-link"
   data-video="https://www.youtube.com/embed/DurgmVgv3ug?si=Dnz5XOcfYtt3xsKC">
	ุนุฑุต ุงูุชุตููู ูุงูุงููุงุฏ ุจุดูู ูุจุณุท
</a>


<a href="#" class="video-link" data-article="codes-article">
  ููุงูุงุช
</a>



</div>

<template id="codes-article">
  <div dir="rtl" class="article-content">
     
	<h2>ุดุฑุญ ููุฏ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ุจูุบุฉ VBA</h2>

    <h3>ุงูููุฏ ุงููุงูู:</h3>
    <pre dir= "ltr">
Option Compare Database
Option Explicit

Private Sub btnSave_Click()
    On Error GoTo ErrHandler

    Dim db As DAO.Database
    Dim rs As DAO.Recordset
    Dim ReqID As Long

    ReqID = Me.txtPK_Req.Value
    Set db = CurrentDb

    ' Open the record we want to update
    Set rs = db.OpenRecordset("SELECT * FROM tbl_Reqs WHERE PK_Req=" & ReqID & ";")

    If Not rs.EOF Then
        rs.Edit
        rs!Req_info = Me.txtinfo_Req.Value
        rs!mem_Req = Me.txtMem_Req.Value
        rs.Update
        Call loadTreeView
        DoCmd.RunCommand acCmdSaveRecord
        DoCmd.RunCommand acCmdRefresh
        MsgBox "Changes saved successfully!", vbInformation
    Else
        MsgBox "Record not found!", vbExclamation
    End If

    rs.Close
    Set rs = Nothing
    Set db = Nothing
    Exit Sub

ErrHandler:
    MsgBox "Error: " & Err.Description, vbCritical
End Sub

Private Sub Form_Load()
    ' Load the treeview
    Call loadTreeView
    
    ' Change font size for the entire treeview
    Me.treeReqs.Font.Size = 10
    Me.treeReqs.Font.Name = "Segoe UI"
End Sub

Private Sub treeReqs_NodeClick(ByVal Node As Object)
    Dim lngID As Long
    lngID = CLng(Mid(Node.Key, 2))
    Call showNodeDetails(lngID)
End Sub

Private Sub showNodeDetails(lngID As Long)
    Dim rs As DAO.Recordset
    Dim frm As Form

    Set frm = Forms("TreeView_Example")
    
    Set rs = CurrentDb.OpenRecordset( _
        "SELECT R.PK_Req, R.mem_Req, R.ID_Parent, R.dbi_Sort, R.Req_info, T.tx_Type " & _
        "FROM tbl_Reqs AS R " & _
        "LEFT JOIN tbl_Type AS T ON R.ID_Type = T.PK_Type " & _
        "WHERE R.PK_Req=" & lngID, dbOpenSnapshot)
    
    If Not rs.EOF Then
        frm!txtPK_Req = rs!PK_Req
        frm!txtMem_Req = rs!mem_Req
        frm!txtID_Parent = rs!ID_Parent
        frm!txtDbi_Sort = rs!dbi_Sort
        frm!txtID_Type = rs!tx_Type
        frm!txtinfo_Req = rs!Req_info
    End If
    
    rs.Close
End Sub
    </pre>

     <p><strong>ุดุฑุญ ุงูููุฏ ูููุจุชุฏุฆูู:</strong></p>

  <p>ูุฐุง ุงูููุฏ ููุชูุจ ุจูุบุฉ <strong>VBA ุฏุงุฎู ูุงุนุฏุฉ ุจูุงูุงุช Access</strong>ุ ูุงูุบุฑุถ ููู ูู ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ูู ูููุฐุฌ (Form) ุจุทุฑููุฉ ููุธูุฉ ูุณููุฉ. ุญุชู ูู ูู ููู ูุฏูู ุฃู ุฎุจุฑุฉ ุจุฑูุฌูุฉุ ุณุฃุดุฑุญ ูู <strong>ูุง ูููู ุจู ูู ุฌุฒุก ุจุทุฑููุฉ ุจุณูุทุฉ</strong>:</p>

  <h3>1๏ธโฃ Option Compare Database ู Option Explicit</h3>
  <p>
    <strong>Option Compare Database</strong>: ูุฎุจุฑ ุงูุจุฑูุงูุฌ ููู ููุงุฑู ุงููุตูุต (Strings) ุฏุงุฎู ูุงุนุฏุฉ ุงูุจูุงูุงุช.<br>
    <strong>Option Explicit</strong>: ููุฑุถ ุนููู ุชุนุฑูู ูู ุงููุชุบูุฑุงุช ูุจู ุงุณุชุฎุฏุงููุงุ ููุฐุง ูููุน ุงูุฃุฎุทุงุก ุงููุงุชุฌุฉ ุนู ุงููุชุงุจุฉ ุงูุฎุงุทุฆุฉ ููุฃุณูุงุก.<br>
    ุงูููุฑุฉ: ูุฐู ุงูุฃุณุทุฑ ุชุฌุนู ุงูุจุฑูุงูุฌ ุฃูุซุฑ ุฃูุงููุง ูุฃุณูู ููุชุตุญูุญ.
  </p>

  <h3>2๏ธโฃ ุงูุฒุฑ btnSave_Click</h3>
  <p>
    ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ <strong>ุญูุธ</strong>:
    <ul>
      <liููุชุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ.</li>
      <li>ูุจุญุซ ุนู ุงูุณุฌู ุจุงุณุชุฎุฏุงู ุฑูู ุงูุชุนุฑูู ReqID.</li>
      <li>ุฅุฐุง ูุฌุฏ ุงูุณุฌู: ูุบูุฑ ุงูุจูุงูุงุช ููุญุฏุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ.</li>
      <li>ุฅุฐุง ูู ูุฌุฏ ุงูุณุฌู: ูุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ.</li>
    </ul>
    <strong>ุจุจุณุงุทุฉ:</strong> ูุณูุญ ูู ุจุชุญุฏูุซ ุงููุนูููุงุช ูุฑุคูุฉ ุงููุชุงุฆุฌ ูุจุงุดุฑุฉ.
  </p>

  <h3>3๏ธโฃ ุชุญููู ุงููููุฐุฌ Form_Load</h3>
  <p>
    ุนูุฏ ูุชุญ ุงููููุฐุฌ:
    <ul>
      <li>ูุชู ุชุญููู ุดุฌุฑุฉ ุงูุจูุงูุงุช TreeView ุชููุงุฆููุง.</li>
      <li>ูุชู ุถุจุท ุงูุฎุท ูุญุฌูู ูุชุณููู ุงููุฑุงุกุฉ.</li>
    </ul>
  </p>

  <h3>4๏ธโฃ ุงูููุฑ ุนูู ุนูุตุฑ ูู ุงูุดุฌุฑุฉ treeReqs_NodeClick</h3>
  <p>
    ุนูุฏ ุงุฎุชูุงุฑ ุฃู ุนูุตุฑ ูู ุดุฌุฑุฉ ุงูุจูุงูุงุชุ ูุชู ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ showNodeDetails ูุนุฑุถ ูู ุงููุนูููุงุช ุงูุฎุงุตุฉ ุจูุฐุง ุงูุณุฌู.
  </p>

  <h3>5๏ธโฃ ุงูุฏุงูุฉ showNodeDetails(lngID)</h3>
  <p>
    ุชุฌูุจ ุฌููุน ุงูุชูุงุตูู ุงูุฎุงุตุฉ ุจุงูุณุฌู ุงููุญุฏุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุนุฑุถูุง ูู ุงููููุฐุฌ.
    <ul>
      <li>ุชุดูู ุงูุญููู PK_Req, mem_Req, ID_Parent, dbi_Sort, Req_info.</li>
      <li>ุชุนุฑุถ ููุน ุงูุณุฌู ูู ุฌุฏูู tbl_Type.</li>
    </ul>
    ุงููุฏู: ุนุฑุถ ุงููุนูููุงุช ุจุทุฑููุฉ ููุธูุฉ ูุณููุฉ ูููุณุชุฎุฏู.
  </p>

	 
  <h3>๐ ุฃุฌุฒุงุก ููููู ุชุนุฏูููุง</h3>
  <p>
    ุฅููู ุฃุจุฑุฒ ุงูุฃุดูุงุก ุงูุชู ูููู ูููุจุชุฏุฆูู ุชุนุฏูููุง ุจุฃูุงู:<br>
    1. ูุต ุงูุญููู ูู ุงููููุฐุฌ <code>txtinfo_Req</code> ุฃู <code>txtMem_Req</code>.<br>
    2. ุญุฌู ุงูุฎุท ูููุนู ุนูุฏ ุชุญููู ุงููููุฐุฌ ูู <code>Form_Load</code>.<br>
    3. ุงูุฑุณุงุฆู ุงูุชู ุชุธูุฑ ุจุนุฏ ุงูุญูุธ ูุซู <code>MsgBox "Changes saved successfully!"</code>.<br>
    4. ุชุฑุชูุจ ุฃู ุฃุณูุงุก ุงูุญููู ุงูุชู ุชุธูุฑ ุนูุฏ ุงูุถุบุท ุนูู ุงูุนูุฏุฉ ูู <code>treeReqs_NodeClick</code>.
  </p>
  
	 <h3>ููุฏูู ุงูุฎุงุต ุจุงูุงุณุชุฏุนุงุก</h3>
	 <pre dir="ltr">
Option Compare Database
Option Explicit

' ===============================
' Build TreeView
' ===============================
Public Sub loadTreeView()
    Dim tv As MSComctlLib.TreeView
    Set tv = Forms("TreeView_Example").treeReqs.Object

    tv.Nodes.Clear

    Dim rsReqs As DAO.Recordset
    Set rsReqs = CurrentDb.OpenRecordset("SELECT * FROM tbl_Reqs ORDER BY ID_Parent, dbi_Sort", dbOpenDynaset)

    Dim strFind As String
    strFind = "ID_Type=1"
    rsReqs.FindFirst strFind
    Dim nodx As MSComctlLib.Node

    Dim strBook As String

    Do While Not rsReqs.NoMatch
        Set nodx = tv.Nodes.Add(, , "N" & rsReqs!PK_Req, rsReqs!mem_Req)
        nodx.Bold = True

        strBook = rsReqs.Bookmark
        addChildren tv, nodx, rsReqs, rsReqs!PK_Req
        rsReqs.Bookmark = strBook
        rsReqs.FindNext strFind
    Loop

    rsReqs.Close
    Set rsReqs = Nothing
End Sub

' ===============================
' Recursive add children
' ===============================
Private Sub addChildren(tv As TreeView, nodParent As Node, rsReqs As DAO.Recordset, lngParentID As Long)
    Dim strFind As String
    strFind = "ID_Parent=" & lngParentID
    rsReqs.FindFirst strFind

    Dim nodx As Node
    Dim strBook As String
    
    Do While Not rsReqs.NoMatch
        Set nodx = tv.Nodes.Add(nodParent, tvwChild, "N" & rsReqs!PK_Req, Left(rsReqs!mem_Req, 50))
       
        Select Case rsReqs!ID_Type
            Case 2
                nodx.Bold = True
            Case 4
                nodx.ForeColor = vbBlue
        End Select
        
        strBook = rsReqs.Bookmark
        addChildren tv, nodx, rsReqs, rsReqs!PK_Req
        rsReqs.Bookmark = strBook
        
        rsReqs.FindNext strFind
    Loop
End Sub

' ===============================
' Show details of clicked node
' ===============================
Private Sub showNodeDetails(lngID As Long)
    Dim rs As DAO.Recordset
    Dim frm As Form
    
    Set frm = Forms("TreeView_Example")
    
    Set rs = CurrentDb.OpenRecordset( _
        "SELECT R.PK_Req, R.mem_Req, R.ID_Parent, R.dbi_Sort, R.Req_info, T.tx_Type " & _
        "FROM tbl_Reqs AS R " & _
        "LEFT JOIN tbl_Type AS T ON R.ID_Type = T.PK_Type " & _
        "WHERE R.PK_Req=" & lngID, dbOpenSnapshot)
    
    If Not rs.EOF Then
        frm!txtPK_Req = rs!PK_Req
        frm!txtMem_Req = rs!mem_Req
        frm!txtID_Parent = rs!ID_Parent
        frm!txtDbi_Sort = rs!dbi_Sort
        frm!txtID_Type = rs!tx_Type
        frm!txtinfo_Req = rs!Req_info
    End If

    rs.Close
End Sub
  </pre>

  <!-- ==== EXPLANATION SECTION ==== -->
  <p><strong>ุดุฑุญ ุงูููุฏ ูููุจุชุฏุฆูู:</strong></p>

  <p>ูุฐุง ุงูููุฏ ูู ุฌุฒุก ูู ูุญุฏุฉ Module ูู Access VBAุ ููู ูุณุคูู ุนู <strong>ุฅูุดุงุก ูุนุฑุถ ุดุฌุฑุฉ ุงูุจูุงูุงุช (TreeView)</strong> ุจุทุฑููุฉ ููุธูุฉ ูุณููุฉ. ุญุชู ูู ูู ุชููู ุงูุชูุงุตูู ุงูุจุฑูุฌูุฉุ ุงููุฏู ุงูุฑุฆูุณู ูู ุฃู ููุถุญ ูู ููู ูุชู ุชูุธูู ูุนุฑุถ ุงูุจูุงูุงุช ุจุดูู ูุฑูู.</p>

  <h3>1๏ธโฃ ุงูุฏุงูุฉ loadTreeView</h3>
  <p>
    - ุชููู ุจุชุญููู ูู ุงูุณุฌูุงุช ูู ุฌุฏูู <strong>tbl_Reqs</strong>.<br>
    - ุชูุณุญ ุฃู ุนูุฏ (Nodes) ููุฌูุฏุฉ ูู TreeView ูุจู ุงูุจุฏุก.<br>
    - ุชุถูู ุงูุนูุฏ ุงูุฑุฆูุณูุฉ (Root Nodes) ูู ุงูุดุฌุฑุฉ.<br>
    - ููู ุนูุฏุฉ ุฑุฆูุณูุฉุ ุชุณุชุฏุนู ุงูุฏุงูุฉ <strong>addChildren</strong> ูุฅุถุงูุฉ ุงูุนูุงุตุฑ ุงููุฑุนูุฉ ุจุดูู ูุชูุฑุฑ.
  </p>

  <h3>2๏ธโฃ ุงูุฏุงูุฉ addChildren</h3>
  <p>
    - ูุฐู ุฏุงูุฉ <strong>Recursive</strong>ุ ุฃู ุฃููุง ุชูุงุฏู ููุณูุง ูุฅุถุงูุฉ ุฌููุน ุงูุนูุงุตุฑ ุงููุฑุนูุฉ ููู ุนูุฏุฉ.<br>
    - ุชุญุฏุฏ ููู ุงููุต ุฃู ุฌุนูู Bold ุญุณุจ ููุน ุงูุนูุตุฑ (ID_Type).<br>
    - ุชุถูู ุฃู ูู ุนูุฏุฉ ูุฑุนูุฉ ููุง ููุชุงุญ ูุฑูุฏ Key ุจุญูุซ ูุณูู ุงูุชูููุฒ ุจูููุง.
  </p>

  <h3>3๏ธโฃ ุงูุฏุงูุฉ showNodeDetails</h3>
  <p>
    - ุนูุฏ ุงูุถุบุท ุนูู ุฃู ุนูุฏุฉ ูู TreeViewุ ูุฐู ุงูุฏุงูุฉ ุชุฌูุจ ูู ุงูุชูุงุตูู ุงูุฎุงุตุฉ ุจูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.<br>
    - ุชุนุฑุถ ุงููุนูููุงุช ูู ุงููููุฐุฌ ุงูุฑุฆูุณู <strong>TreeView_Example</strong>.<br>
    - ุชุชูุญ ูู ูุดุงูุฏุฉ ุฃู ุชุนุฏูู ุฃู ุชูุงุตูู ุจุณูููุฉ.
  </p>
  
  <h3>๐ ุฃุฌุฒุงุก ููููู ุชุนุฏูููุง</h3>
  <p>
    ุฅููู ุฃุจุฑุฒ ุงูุฃุดูุงุก ุงูุชู ููููู ุชุนุฏูููุง ุจุฃูุงู ูุชุฌุฑุจุฉ ุงูููุฏ ููููู:<br><br>
    1. <strong>ูุต ุงูุนูุฏุฉ:</strong> ููููู ุชุบููุฑ ุงูููู ูู ุญูู <code>mem_Req</code> ูู ุฌุฏูู <strong>tbl_Reqs</strong>ุ ูุณุชุธูุฑ ุงูุชุบููุฑุงุช ูุจุงุดุฑุฉ ูู TreeView.<br><br>
    2. <strong>ุฎุท ุงููุต:</strong> ูู ุงูุฏุงูุฉ <code>loadTreeView</code>ุ ููููู ุชุนุฏูู
       <code>tv.Nodes.Clear</code> ูุฎุตุงุฆุต <code>Bold</code> ู <code>ForeColor</code> ูุชุบููุฑ ุดูู ุงูุนูุฏุฉ.<br><br>
    3. <strong>ุฃุณูุงุก ุงูุญููู:</strong> ุฅุฐุง ุฃุฑุฏุชุ ููููู ุชุนุฏูู ุฃุณูุงุก ุงูุญููู ุงูุธุงูุฑุฉ ูู ุงููููุฐุฌ <strong>TreeView_Example</strong> ูุชุบููุฑ ูุง ูุนุฑุถู <code>showNodeDetails</code>.<br><br>
    4. <strong>ููู ุงููุต:</strong> ูู <code>addChildren</code> ููููู ุชุบููุฑ ููู <code>vbBlue</code> ุฃู <code>Bold</code> ูุฃู ููุน ID_Type ุชุฑูุฏู.<br><br>
    5. <strong>ุชุฑุชูุจ ุงูุนูุงุตุฑ:</strong> ุชุนุฏูู ุงูุญูู <code>dbi_Sort</code> ูู ุงูุฌุฏูู ุณูุคุซุฑ ุนูู ุชุฑุชูุจ ุงูุนูุฏ ูู ุงูุดุฌุฑุฉ.
  </p>
  </div>
</template>

<!-- JAVASCRIPT FILE -->
<script src="script.js"></script>
</body>
</html>





